<html>
<head>
  <script>
  window.onload = function() {
    console.log("LOADED");

    //Configuration variables
    var updateInterval = 1000 //in ms
    var numberElements = 30;

    //Globals
    var updateCount = 0;

    // Chart Objects
    var tempChart = $("#tempChart");
    var humChart = $("#humChart");
    var pressChart = $("#pressChart");

    //chart instances & configuration

    var commonOptions = {
        scales: {
          xAxes: [{
            type: 'time',
            time: {
              displayFormats: {
                millisecond: 'hh:mm'
              }
            }
          }],
            yAxes: [{
                ticks: {
                    beginAtZero:true
                }
            }]
        },
        legend: {display: false},
        tooltips:{
          enabled: false
        }
    };
    var tempChartInstance = new Chart(tempChart, {
        type: 'line',
        data: {
          datasets: [{
              label: "Temp",
              data: 0,
              fill: false,
              borderColor: '#343e9a',
              borderWidth: 1
          }]
        },
        options: Object.assign({}, commonOptions, {
          title:{
            display: true,
            text: "Temp",
            fontSize: 18
          }
        })
    });

    var humChartInstance = new Chart(humChart, {
        type: 'line',
        data: {
          datasets: [{
              label: "Humidity",
              data: 0,
              fill: false,
              borderColor: '#343e9a',
              borderWidth: 1
          }]
        },
        options: Object.assign({}, commonOptions, {
          title:{
            display: true,
            text: "Humidity",
            fontSize: 18
          }
        }) 
      });

    var pressChartInstance = new Chart(pressChart, {
        type: 'line',
        data: {
          datasets: [{
              label: "Pressure",
              data: 0,
              fill: false,
              borderColor: '#343e9a',
              borderWidth: 1
          }]
        },
        options: Object.assign({}, commonOptions, {
          title:{
            display: true,
            text: "Pressure",
            fontSize: 18
          }
        })
      });


    function addData(data) {
      if(data){
        tempChartInstance.data.labels.push(new Date());
        tempChartInstance.data.datasets.forEach((dataset) =>{dataset.data.push(data['temp'])});
        humChartInstance.data.labels.push(new Date());
        humChartInstance.data.datasets.forEach((dataset) =>{dataset.data.push(data['hum'])});
        pressChartInstance.data.labels.push(new Date());
        pressChartInstance.data.datasets.forEach((dataset) =>{dataset.data.push(data['press'])});
        if(updateCount > numberElements){
          tempChartInstance.data.labels.shift();
          tempChartInstance.data.datasets[0].data.shift();
          humChartInstance.data.labels.shift();
          humChartInstance.data.datasets[0].data.shift();
          pressChartInstance.data.labels.shift();
          pressChartInstance.data.datasets[0].data.shift();
        }
        else updateCount++;
        tempChartInstance.update();
        humChartInstance.update();
        pressChartInstance.update();
      }
    };

    function updateData() {
      console.log("Update Data");
      $.getJSON("dataFetch.php", addData);
      setTimeout(updateData,updateInterval);
    }

    updateData();
  }
</script>
  <style>
  .container{
    display:flex;

  }


  .a{
    height: 400px;
    width: 800px;
    text-align: center;
    background-color: rgba(51, 45, 45, 0.185);
    margin: 10px;
  }
  .b{
    height: 400px;
    width: 800px;
    text-align: center;
    background-color: rgba(51, 45, 45, 0.185);
    margin: 10px;
  }
  .c{
    height: 400px;
    width: 800px;
    text-align: center;
    background-color: rgba(51, 45, 45, 0.185);
    margin: 10px;
  }


  h1{
    text-align: center;
  }

  </style>

    <script type="text/javascript" src="http://ajax.googleapis.com/ajax/libs/jquery/1.4.1/jquery.js"></script>
    <script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/Chart.js/2.7.2/Chart.bundle.js"></script>
</head>
<body>
  
  <div class="container">

  <div id="chart" class="a">
    <canvas id="tempChart"></canvas>
  </div>
  <div id="chart" class="b">
    <canvas id="humChart"></canvas>
  </div>
  <div id="chart" class="c">
    <canvas id="pressChart"></canvas>
  </div>

  <form action="input.php" method="post">
  <label for="input">Input</label><br>
  <input type="text" id="input" name="input"><br>
  <input type="submit" value="Submit">
</form> 
  </div>


</body>
</html>
